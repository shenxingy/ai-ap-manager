# ─── Database ───
DATABASE_URL=postgresql+asyncpg://ap_user:ap_pass@localhost:5432/ap_db
# Sync URL for Alembic migrations (uses psycopg2, not asyncpg)
DATABASE_URL_SYNC=postgresql://ap_user:ap_pass@localhost:5432/ap_db

# ─── Redis ───
REDIS_URL=redis://localhost:6379/0
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/1

# ─── MinIO (Object Storage) ───
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET_NAME=ap-documents
MINIO_SECURE=false   # set to true in production (HTTPS)

# ─── AI / LLM ───
ANTHROPIC_API_KEY=sk-ant-...
# Model to use for invoice extraction and policy parsing
ANTHROPIC_MODEL=claude-sonnet-4-6
# Skip OCR and use Claude's vision capability directly (set true if Tesseract quality is poor)
USE_CLAUDE_VISION=false

# ─── Auth / Security ───
# JWT signing secret — generate with: openssl rand -hex 32
JWT_SECRET=change_me_generate_with_openssl_rand_hex_32
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7
# HMAC secret for email approval tokens — generate with: openssl rand -hex 32
APPROVAL_TOKEN_SECRET=change_me_generate_with_openssl_rand_hex_32
APPROVAL_TOKEN_EXPIRE_HOURS=48

# ─── Application ───
APP_ENV=development   # development | staging | production
APP_BASE_URL=http://localhost:8000
FRONTEND_URL=http://localhost:3000
# CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3000

# ─── Email (for approval notifications) ───
# Set MAIL_ENABLED=false in development to just print emails to console
MAIL_ENABLED=false
MAIL_FROM=ap-system@yourcompany.com
MAIL_FROM_NAME=AP Operations
# SMTP settings (only needed if MAIL_ENABLED=true)
MAIL_HOST=smtp.yourcompany.com
MAIL_PORT=587
MAIL_USER=
MAIL_PASSWORD=
MAIL_TLS=true

# ─── OCR ───
# Tesseract binary path (usually auto-detected, override if needed)
# TESSERACT_CMD=/usr/bin/tesseract
# Min OCR confidence to proceed without human review (0.0 - 1.0)
OCR_MIN_CONFIDENCE=0.75
# Max number of field mismatches between dual-pass before flagging for review
DUAL_PASS_MAX_MISMATCHES=1

# ─── Business Rules ───
# Auto-approve invoices below this amount (matched invoices only, USD)
AUTO_APPROVE_THRESHOLD=5000.00
# Days to look back for duplicate invoice detection
DUPLICATE_DETECTION_WINDOW_DAYS=7
# Fraud score thresholds
FRAUD_SCORE_MEDIUM_THRESHOLD=20
FRAUD_SCORE_HIGH_THRESHOLD=40
FRAUD_SCORE_CRITICAL_THRESHOLD=60

# ─── Error Monitoring (Sentry) ───
SENTRY_DSN=                # leave blank to disable, or set your DSN
SENTRY_TRACES_SAMPLE_RATE=0.1
